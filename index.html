<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#F4A63A" />
  <title>感恩日記熊</title>

  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="apple-touch-icon" href="./icons/icon-192.png" />
  <link rel="stylesheet" href="./styles.css" />
</head>

<body>
  <div class="app-wrap">

    <!-- Header -->
    <header class="topbar">
      <div class="brand">
        <button class="avatar-btn" id="avatarBtn" title="點我換一句小語">
          <img id="avatarImg" class="avatar-img" src="./images/bear.png" alt="熊熊大頭貼" />
        </button>

        <div class="brand-text">
          <a class="title-link" href="https://instagram.com/luckygbear" target="_blank" rel="noopener">
            感恩日記熊 <span class="ig-tag">@luckygbear</span>
          </a>

          <button class="datebtn" id="datePickBtn" type="button">
            <span id="dateText"></span> ▾
          </button>
        </div>
      </div>

      <input id="datePicker" class="datePicker" type="date" />
    </header>

    <!-- Pages -->
    <main class="pages">

      <!-- Home -->
      <section class="page active" id="pageHome">
        <div class="card bubble-wrap flip-card" id="homeBubbleCard">
          <div class="bubble" id="quoteBubble" title="長按可複製"></div>
          <div class="bubble-hint">長按可複製小語｜點熊熊頭像可換一句</div>
        </div>

        <div class="card task-card flip-card" id="taskCard">
          <div class="card-title">🌱 今日感恩任務</div>
          <div class="task-text" id="taskText"></div>

          <div class="task-actions">
            <button class="btn primary" id="taskDoneBtn" type="button">完成打勾 ✅</button>
            <button class="btn" id="taskSwapBtn" type="button">換一個 🔄</button>
          </div>

          <div class="task-state" id="taskState"></div>
          <div class="fx-layer" id="taskFxLayer" aria-hidden="true"></div>
        </div>

        <div class="card mini flip-card tip-card" id="homeTipCard" title="點一下換提示">
          <div class="card-title">📌 今日小提示（點一下換）</div>
          <div class="muted" id="tipText"></div>
        </div>

        <div class="card flip-card" id="recentCard">
          <div class="card-title">📚 最近日記回顧</div>
          <div class="muted small">顯示最新三筆；左右滑動可回看更多；點一下展開。</div>
          <div class="recent-list" id="recentList"></div>
        </div>
      </section>

      <!-- Write -->
      <section class="page" id="pageWrite">
        <div class="card">
          <div class="card-title">✍️ 寫下今天的感恩</div>

          <label class="label">日期</label>
          <input type="date" id="writeDate" class="input" />

          <label class="label">我今天感謝的 3 件小事</label>
          <textarea id="field3things" class="textarea" rows="4" placeholder="例如：1) 起床喝溫水 2) 朋友的訊息 3) 夕陽很美"></textarea>

          <label class="label">今天最幸福的一刻是…</label>
          <textarea id="fieldMoment" class="textarea" rows="3" placeholder="把那個瞬間記下來"></textarea>

          <label class="label">我想對自己說…</label>
          <textarea id="fieldSelf" class="textarea" rows="3" placeholder="辛苦了、謝謝你、你很棒…"></textarea>

          <label class="label">上傳照片（最多 3 張）</label>
          <input type="file" id="photoInput" class="input" accept="image/*" multiple />
          <div class="photo-grid" id="photoGrid"></div>

          <div class="row">
            <button class="btn primary full" id="saveEntryBtn" type="button">儲存今天的日記 💛</button>
          </div>
          <div class="muted" id="saveState"></div>
        </div>
      </section>

      <!-- Journal -->
      <section class="page" id="pageJournal">
        <div class="card">
          <div class="card-title">📚 我的日記本</div>
          <div class="muted">點一篇就能回看你走過的幸福（彈跳視窗）。</div>
        </div>
        <div id="journalList" class="list"></div>
      </section>

      <!-- Settings -->
      <section class="page" id="pageSettings">
        <div class="card">
          <div class="card-title">⚙️ 設定</div>

          <div class="setting-block">
            <div class="label">大頭貼（可上傳自己的照片）</div>
            <input type="file" id="avatarInput" class="input" accept="image/*" />
            <div class="row">
              <button class="btn full" id="resetAvatarBtn" type="button">還原預設熊熊頭像</button>
            </div>
            <div class="muted small">照片只儲存在本機（localStorage），換手機需重新上傳。</div>
          </div>

          <hr class="sep" />

          <button class="btn full" id="exportBtn" type="button">匯出 JSON（複製到剪貼簿）</button>
          <button class="btn danger full" id="clearBtn" type="button">清除所有資料</button>
          <div class="muted small">需要雲端同步/備份也可以再加。</div>
        </div>
      </section>
    </main>

    <!-- Bottom Nav -->
    <nav class="bottom-nav">
      <button class="navbtn active" data-go="home" type="button">🏠<span>首頁</span></button>
      <button class="navbtn" data-go="write" type="button">＋<span>寫日記</span></button>
      <button class="navbtn" data-go="journal" type="button">📚<span>日記本</span></button>
      <button class="navbtn" data-go="settings" type="button">⚙️<span>設定</span></button>
    </nav>
  </div>

  <!-- Modal -->
  <div class="modal hidden" id="entryModal" aria-hidden="true">
    <div class="modal-backdrop" id="modalBackdrop"></div>
    <div class="modal-sheet" role="dialog" aria-modal="true">
      <div class="modal-handle"></div>
      <div class="modal-header">
        <div class="modal-title" id="modalTitle">📖 日記</div>
        <button class="modal-close" id="modalCloseBtn" type="button" aria-label="關閉">✕</button>
      </div>

      <div class="modal-body">
        <div class="photo-grid" id="modalPhotos"></div>

        <div class="block">
          <div class="label">我今天感謝的 3 件小事</div>
          <div class="text" id="modal3things"></div>
        </div>
        <div class="block">
          <div class="label">今天最幸福的一刻</div>
          <div class="text" id="modalMoment"></div>
        </div>
        <div class="block">
          <div class="label">我想對自己說</div>
          <div class="text" id="modalSelf"></div>
        </div>

        <div class="row">
          <button class="btn" id="modalEditBtn" type="button">編輯</button>
          <button class="btn danger" id="modalDeleteBtn" type="button">刪除</button>
        </div>
      </div>
    </div>
  </div>

  <script src="./app.js"></script>
</body>
</html>